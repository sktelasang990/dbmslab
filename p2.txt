CREATE TABLE SALESMAN (
    SALESMAN_ID INT(4),
    NAME VARCHAR(20),
    CITY VARCHAR(20),
    COMMISSION VARCHAR(20),
    PRIMARY KEY (SALESMAN_ID)
);

CREATE TABLE CUSTOMER1 (
    CUSTOMER_ID INT(4),
    CUST_NAME VARCHAR(20),
    CITY VARCHAR(20),
    GRADE INT(3),
    SALESMAN_ID INT(4),
    PRIMARY KEY (CUSTOMER_ID),
    FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE SET NULL
);

CREATE TABLE ORDERS (
    ORD_NO INT(5),
    PURCHASE_AMT DECIMAL(10, 2),
    ORD_DATE DATE,
    CUSTOMER_ID INT(4),
    SALESMAN_ID INT(4),
    PRIMARY KEY (ORD_NO),
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER1 (CUSTOMER_ID) ON DELETE CASCADE,
    FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE
);

SELECT GRADE,count(DISTINCT CUSTOMER_ID)
FROM CUSTOMER1
GROUP BY GRADE
HAVING GRADE>(SELECT AVG(GRADE)
FROM CUSTOMER1
WHERE CITY='BANGALORE');

SELECT SALESMAN_ID,NAME
FROM SALESMAN A
WHERE 1 < (SELECT count(*)
FROM CUSTOMER1
WHERE SALESMAN_ID=A.SALESMAN_ID);

SELECT SALESMAN.SALESMAN_ID, NAME,CUST_NAME, COMMISSION
FROM SALESMAN, CUSTOMER1
WHERE SALESMAN.CITY = CUSTOMER1.CITY
UNION
SELECT SALESMAN_ID, NAME, 'NO MATCH', COMMISSION
FROM SALESMAN
WHERE NOT CITY = ANY
(SELECT CITY
FROM CUSTOMER1)
ORDER BY 2 DESC;

CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME
FROM SALESMAN A, ORDERS B
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX (PURCHASE_AMT)
FROM ORDERS C
WHERE C.ORD_DATE=B.ORD_DATE);

DELETE FROM SALESMAN
WHERE SALESMAN_ID=1000;
